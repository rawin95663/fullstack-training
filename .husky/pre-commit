#!/bin/sh
. "$(dirname "$0")/_/husky.sh"

echo "ğŸ” Running format and lint for changed packages..."

# Get list of changed files
CHANGED_FILES=$(git diff --cached --name-only --diff-filter=ACMR)

if [ -z "$CHANGED_FILES" ]; then
  echo "No staged files to check."
  exit 0
fi

echo "Changed files:"
echo "$CHANGED_FILES"

# Run format and lint for affected packages
echo "ğŸ¨ Formatting code..."
pnpm turbo format --filter="[HEAD]" || exit 1

echo "ğŸ” Linting code..."
pnpm turbo lint --filter="[HEAD]" || exit 1

echo "ğŸ” Type checking..."
pnpm turbo type-check --filter="[HEAD]" || exit 1

echo "âœ… All checks passed!" 